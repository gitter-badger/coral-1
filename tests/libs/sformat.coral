

type Formatter(T, U):
  pass

func toString(f: StopFormatter): return ""
func toString(f: Formatter): return show (f.val) + toString (f.next)
func writeTo(f: StopFormatter): return
func writeTo(s : Stream, f: Formatter): writeTo(showTo(s, f.val), f.next)

macro format(fmt: String, ...args):
  for part in regex.split("%.", fmt):
    match part:
       "%s": Formatter[String, _](head args)
       "%i": Formatter[Integer, _](head args)
